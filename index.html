<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <title>Redireccionando a WhatsAppâ€¦</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
</head>
<body>

<script>
  // =========================
  // PARÃMETROS DESDE BASE44
  // =========================
  const params = new URLSearchParams(window.location.search);

  const tipo     = params.get("tipo");        // tipo de mensaje
  const nombre   = params.get("nombre");      // nombre socio / entrenador
  const plan     = params.get("plan");        // plan
  const fecha    = params.get("fecha");       // fecha vencimiento
  const telefono = params.get("telefono");    // DESTINO WHATSAPP (OBLIGATORIO)
  const link     = params.get("link")
    ? decodeURIComponent(params.get("link"))
    : "";

  // =========================
  // VALIDACIÃ“N BÃSICA
  // =========================
  if (!telefono) {
    alert("Error: no se recibiÃ³ el telÃ©fono del socio.");
    throw new Error("Parametro 'telefono' faltante");
  }

  let mensaje = "";

  // =========================
  // ROUTER DE MENSAJES
  // =========================

  // 1ï¸âƒ£ Bienvenida socio
  if (tipo === "bienvenida_socio" && nombre) {
    mensaje =
`ğŸ‘‹ Hola ${nombre}!

ğŸ‰ Bienvenido/a a *Valencia Gym* ğŸ’ª
${plan ? `\nElegiste el plan *${plan}*` : ""}
${fecha ? `\nğŸ“… Vencimiento mensual: ${fecha}` : ""}

${link ? `\nğŸ”— Tu perfil de socio:\n${link}` : ""}

Desde ahÃ­ vas a poder:
ğŸ‹ï¸â€â™‚ï¸ Ver tu rutina personalizada
ğŸ“† Inscribirte a actividades
â„¹ï¸ Acceder a toda la info del gym

Â¡A entrenar! ğŸ”¥`;
  }

  // 2ï¸âƒ£ Bienvenida entrenador
  else if (tipo === "bienvenida_entrenador" && nombre) {
    mensaje =
`ğŸ‘‹ Hola ${nombre}!

Bienvenido/a al equipo de *Valencia Gym* ğŸ’ª

${link ? `ğŸ”— Acceso a tu perfil de entrenador:\n${link}\n` : ""}
Â¡Vamos con todo! ğŸ”¥`;
  }

  // 3ï¸âƒ£ CumpleaÃ±os socio
  else if (tipo === "cumple_socio" && nombre) {
    mensaje =
`ğŸ‰ Feliz cumple ${nombre}! ğŸ¥³

Todo el equipo de *Valencia Gym* te desea un excelente dÃ­a ğŸ’ª
Gracias por entrenar con nosotros.

Â¡Que sea un gran aÃ±o! ğŸ”¥`;
  }

  // 4ï¸âƒ£ CumpleaÃ±os entrenador
  else if (tipo === "cumple_entrenador" && nombre) {
    mensaje =
`ğŸ‰ Feliz cumple ${nombre}! ğŸ¥³

Gracias por ser parte del equipo de *Valencia Gym* ğŸ’ª
Que tengas un aÃ±o lleno de energÃ­a y buenos entrenamientos.

Â¡Vamos! ğŸ”¥`;
  }

  // 5ï¸âƒ£ Recordatorio: faltan 5 dÃ­as
  else if (tipo === "recordatorio_5_dias" && nombre && fecha) {
    mensaje =
`â° Hola ${nombre}

Te recordamos que en *5 dÃ­as* vence tu membresÃ­a mensual
ğŸ“… Fecha de vencimiento: *${fecha}*

Para seguir entrenando sin interrupciones, podÃ©s regularizarla cuando quieras ğŸ’ª
Cualquier duda, estamos a disposiciÃ³n.

Â¡Te esperamos en Valencia Gym! ğŸ”¥`;
  }

  // 6ï¸âƒ£ Vence hoy
  else if (tipo === "vencimiento_proximo" && nombre && fecha) {
    mensaje =
`â° Hola ${nombre}

Tu membresÃ­a mensual vence *hoy*
ğŸ“… Fecha de vencimiento: *${fecha}*

PodÃ©s regularizarla para continuar entrenando con normalidad ğŸ’ª
Cualquier consulta, escribinos o acercate a la recepciÃ³n.

Â¡Gracias por entrenar en Valencia Gym! ğŸ”¥`;
  }

  // 7ï¸âƒ£ Cuota vencida
  else if (tipo === "cuota_vencida" && nombre && fecha) {
    mensaje =
`âš ï¸ Hola ${nombre}

Tu membresÃ­a mensual venciÃ³ el *${fecha}*.

Para regularizarla y continuar entrenando, podÃ©s:
ğŸ’³ Transferir al alias:
*Valencia.gym*
Banco: *Brubank*

o acercarte a la recepciÃ³n del gimnasio y lo resolvemos ahÃ­ mismo ğŸ’ª

Â¡Te esperamos! ğŸ”¥`;
  }

  // 8ï¸âƒ£ Fallback seguro
  else {
    mensaje =
`ğŸ‘‹ Hola!

ğŸ‰ Te esperamos en *Valencia Gym* ğŸ’ª
Consultanos y sumate cuando quieras.

Â¡A entrenar! ğŸ”¥`;
  }

  // =========================
  // REDIRECCIÃ“N A WHATSAPP
  // =========================
  const whatsappUrl =
    "https://api.whatsapp.com/send" +
    "?phone=" + telefono +
    "&text=" + encodeURIComponent(mensaje);

  window.location.replace(whatsappUrl);
</script>

</body>
</html>
